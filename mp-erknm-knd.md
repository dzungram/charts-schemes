# Взаимодействие ЕРКНМ и приложения "Мобильный инспектор"

## Содержание


<!-- @import "[TOC]" {cmd="toc" depthFrom=1 depthTo=6 orderedList=false} -->

<!-- code_chunk_output -->

- [Взаимодействие ЕРКНМ и приложения "Мобильный инспектор"](#взаимодействие-еркнм-и-приложения-мобильный-инспектор)
  - [Содержание](#содержание)
  - [Возможности приложения](#возможности-приложения)
  - [Преимущества приложения](#преимущества-приложения)
  - [Общая схема работы](#общая-схема-работы)
  - [Создание паспорта КНМ (ПМ) в ЕРКНМ](#создание-паспорта-кнм-пм-в-еркнм)
  - [Создание карточки КНМ в приложении "Мобильный инспектор"](#создание-карточки-кнм-в-приложении-мобильный-инспектор)
  - [Взаимодействие с контролируемым лицом](#взаимодействие-с-контролируемым-лицом)

<!-- /code_chunk_output -->



<!-- pagebreak -->

## Возможности приложения

- Фиксация нарушения на фото и видео
- Мероприятия с чек-листом и без него
- Дистанционное взаимодействие (ВКС)
- Контроль подмены геолокации
- Формирование результатов (акты и др.)
- Подписание результатов в "Госключ" (УНЭП, УКЭП и УКЭП должностного лица)

<!-- pagebreak -->

## Преимущества приложения

- Проверка
    - Проведение ВКС с использованием мобильной камеры контролируемого лица и возможностью использовать проверочный лист (чек-лист) для фиксации результатов проверки, которые отображаются у инспектора, и у контролируемого лица

- Формирование результатов проверки
    - В приложении формируется файл печатной формы журнала ВКС:
        - общая информация о мероприятии
        - детализация действий участников ВКС
        - ответы на вопросы проверочного листа
        - сообщения из чата участников ВКС
        - ссылки на файлы из чата участников

- Геолокация
    - В режиме реального времени инспектору доступно местоположение устройства, контролируемого лица и отслеживание перемещений проверяемого во время проверки.    
    - При попытке подменить координаты сторонним программным обеспечением инспектор увидит предупреждение.
    - В случае сбоя геолокации рекомендуется продолжить мероприятие и предложить контролируемому лицу продемонстрировать адресную табличку с названием улицы и номером дома.

- История проверок
    - Доступ к базе данных в мобильном приложении по объектам, нарушениям и предыдущим проверкам, что позволяет инспекторам иметь полную картину ситуации.

- Коммуникация
    - Возможность обмениваться сообщениями и материалами с контролируемым лицом в чате (сообщения, фото, видео, сканы документов), что способствует более эффективному взаимодействию (при проведении ВКС и устранении контролируемым лицом ранее выявленных нарушений).

- Уведомления
    - Уведомление о новых и напоминания о предстоящих мероприятиях доступны для пользователей за 7 дней, 1 день и час до начала.

- Интеграция с другими системами
    - Возможность интеграции с ведомственными информационными системами (ВИС), что позволяет инспектору создать мероприятие в ВИС в привычном формате и затем использовать мобильное приложение для проведения проверки.
    _На данный момент не реализована интеграция приложения с ЕИАС Роспотребнадзора не реализована_


- Цифровые проверочные листы
    - Инспектор выбирает готовый шаблон проверочного листа и отвечает на вопросы, отмечая соблюдение или нарушение требований.

    - При выборе ответа на вопрос проверочного листа инспектором, на экране ВКС у контролируемого лица появляется push-уведомление с выбранным ответом на вопрос.

        - <i class="fa fa-square-check" style="color: green;"></i> если выбран ответ "да"
        - <i class="fa fa-square-check" style="color: red;"></i> если выбран ответ "нет"
        - <i class="fa fa-square-check" style="color: gray;"></i> если выбран ответ "не применимо"
    - Проверочные листы позволяют быстро фиксировать результаты и вносить изменения во время проверки. Данные сохраняются в карточке мероприятия и синхронизируются с ГИС ТОР КНД. При необходимости ответы можно изменить.

    - Инспектор в ходе ВКС может направить чек-лист контролируемому лицу для самостоятельного заполнения. Контролируемо лицо может снимать фото и видео по чек-листу вне зоны доступа мобильной сети и после направить полученный результат инспектору.

<!-- pagebreak -->

## Общая схема работы



<!-- pagebreak -->

## Создание паспорта КНМ (ПМ) в ЕРКНМ

<div align="center">

```mermaid
sequenceDiagram

    box
        actor Inspector as Инспектор
        participant Erknm as ЕРКНМ
    end

    Inspector->>Erknm: Создает карточку КНМ
    activate Erknm
    Erknm-->>Inspector: Выдает номер КНМ
    deactivate Erknm
```
</div>

## Создание карточки КНМ в приложении "Мобильный инспектор"

<div align="center">

Рисунок 1

![alt text](images/mp-inspector.jpg)

```mermaid
flowchart TD
    A[Авторизоваться в приложении с помощью ЕСИА]-->B["Выбрать __Другие мероприятия__"]
    B-->C["Нажать кнопку __Создать__"]
    C-->D[Ввести номер ЕРКНМ]
    D-->E["Нажать кнопку __Создать__"]

```
</div>

## Взаимодействие с контролируемым лицом

```mermaid
sequenceDiagram
        
    box
        actor Inspector as Инспектор
        actor Organization as Контролируемое лицо
    end
    Inspector->>Organization: Уведомление о проведении проверки в Госуслугах
    activate Organization
        Organization-->>Inspector: Подтверждение участия
        Inspector->>Organization: Ссылка на мероприятие
    deactivate Organization
```